{"remainingRequest":"/Users/admin/Desktop/my_page/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/admin/Desktop/my_page/src/views/Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/admin/Desktop/my_page/src/views/Home.vue","mtime":1599122184045},{"path":"/Users/admin/Desktop/my_page/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/admin/Desktop/my_page/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/my_page/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCiBpbXBvcnQgWExTWCBmcm9tICd4bHN4JwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0hvbWUnLAogIGRhdGEoKXsKcmV0dXJuewogICAgY29uZm46J0Nob29zZSBjb25maWcueGxzeCcsCiAgICBjb25mOnt9LAogICAgY29uZms6W10sCiAgICBjb25mdjpbXSwKICAgIGlzU2hvdzpmYWxzZQogIAp9CiAgCiAgfSwKICBjb21wb25lbnRzOiB7CiAgIAogIH0sCiAgIGNyZWF0ZWQoKXsKCiAgICB9LAogICBtb3VudGVkKCl7CgogICAgfSwKICAgIG1ldGhvZHM6ewoKICBmaWxlKCl7CiAgCiBpZih0aGlzLiRyZWZzLmZpbGUuZmlsZXNbMF0peyAgIAogICB0aGlzLmlzU2hvdz10cnVlOwogICAgIH0KCnRoaXMuY29uZm49IHRoaXMuJHJlZnMuZmlsZS5maWxlc1swXS5uYW1lOwoKICAKICAgICAgICAgICAgICAgICAgdmFyIGs9WzFdOwogICAgICAgICAgICAgICAgICB2YXIgdj1bMl07CiAgICAgICAgICAgICAgICAgIHZhciBjPXt9OyAgIAogICAgICAgICAgIHZhciBmPXRoaXMuJHJlZnMuZmlsZS5maWxlc1swXQogICAgICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7IAogICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzQmluYXJ5U3RyaW5nKGYpOwogICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gZS50YXJnZXQucmVzdWx0OwogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgdmFyICAgd2IgPSBYTFNYLnJlYWQoZGF0YSwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2JpbmFyeScKICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgc2VsdGV4dD13Yi5TaGVldE5hbWVzWzBdCgogICAgICAgICAgICAgICAgICAgICB2YXIgY29uZj17fTsKIAogICAgICAgICAgICAgICAgICAgIHZhciBjdXJTaGVldCA9IHdiLlNoZWV0c1tzZWx0ZXh0XTsKICAgICAgICAgICAgICAgICAgICAvLyDooajmoLznmoTooajmoLzojIPlm7TvvIzlj6/nlKjkuo7liKTmlq3ooajlpLTmmK/lkKbmlbDph4/mmK/lkKbmraPnoa4KICAgICAgICAgICAgICAgICAgICB2YXIgZnJvbVRvID0gY3VyU2hlZXRbJyFyZWYnXTsKICAgICAgICAgICAgICAgICAgICBmcm9tVG8gPSBmcm9tVG8uc3BsaXQoIjoiKTsKCiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0Um93ID0gZnJvbVRvWzBdLmNoYXJDb2RlQXQoMCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0TGluZSA9IHBhcnNlSW50KGZyb21Ub1swXS5jaGFyQXQoMSkpOwogICAgICAgICAgICAgICAgICAgIHZhciBlbmRSb3cgPSBmcm9tVG9bMV0uY2hhckNvZGVBdCgwKTsKICAgICAgICAgICAgICAgICAgICB2YXIgZW5kTGluZSA9IHBhcnNlSW50KGZyb21Ub1sxXS5zdWJzdHIoMSkpOwoKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBsaW5lID0gc3RhcnRMaW5lOyBsaW5lIDwgZW5kTGluZTsgbGluZSsrKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXlyb3cgPSBzdGFydFJvdzsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHJvdyA9IHN0YXJ0Um93OyByb3cgPCBlbmRSb3c7IHJvdysrKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjZWxsID0gU3RyaW5nLmZyb21DaGFyQ29kZShyb3cpICsgbGluZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjZWxsU3RyID0gY3VyU2hlZXRbY2VsbF07CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGxTdHIgJiYgY2VsbFN0ci53ICYmIGNlbGxTdHIudy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoa2V5ICAmJiByb3cgPT0ga2V5cm93KzEpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhjZWxsU3RyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25mW2tleV0gPSBjZWxsU3RyLnc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBjZWxsU3RyLnc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleXJvdyA9IHJvdzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBjb25mdj1bXTsKICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gY29uZil7ICAKICAgICAgICAgICAgICAgICAgY29uZnYucHVzaChjb25mW2ldKTsKCiAgICAgICAgICAgICAgICAgIH0KICAgICAgIAogICAgICAgICAgICAgICAgaz1PYmplY3Qua2V5cyhjb25mKTsKICAgICAgICAgICAgICAgIHY9Y29uZnYKICAgICAgICAgICAgICAgIGM9Y29uZjsKICAgICAgICAgICAgIC8vICByZWFkZXIucmVhZEFzQmluYXJ5U3RyaW5nKGYpOwogICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCk9Pnt0aGlzLmNvbmZrPWssdGhpcy5jb25mdj12LHRoaXMuY29uZj1jfSwgMTAwKQogICAgIAogICAgICAgICAgICAgfSwKICBzdGFydCgpewogICAgICAgaWYodGhpcy5jb25mdi5sZW5ndGgpewogICAgICAgCiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Q29uZicsdGhpcy5jb25mKTsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRJc0NvbmYnLHRydWUpOwogICAgY29uc29sZS5sb2codGhpcy4kc3RvcmUuc3RhdGUpCgogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvY29uZmlnJykgICAgICAKICAgICAgICAgICAgIH0KICAKICB9CgogICAgfSwKICAgIHdhdGNoOnsKICAgICAKICAgICAgfSwKICAgIGNvbXB1dGVkOnsKICAgIH0KfQo="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n\n<div>\n<!--     <nav class=\"navbar navbar-expand-md navbar-dark fixed-top bg-dark\">\n  <a class=\"navbar-brand\" href=\"#\">Navbar</a>\n\n</nav> -->\n\n<main role=\"main\">\n\n  <!-- Main jumbotron for a primary marketing message or call to action -->\n  <div class=\"jumbotron\">\n    <div class=\"container\">\n\n<div class=\"input-group mb-3\">\n\n  <div class=\"input-group-prepend\">\n    <span class=\"input-group-text\" v-show=\"isShow\" id=\"inputGroupFileAddon01\" @click='start()'>Start</span>\n  </div>\n  <div class=\"custom-file\">\n    <input type=\"file\" name='file' ref='file' @change='file()' class=\"custom-file-input\" id=\"inputGroupFile01\" aria-describedby=\"inputGroupFileAddon01\">\n    <label class=\"custom-file-label\" for=\"inputGroupFile01\">{{confn}}</label>\n  </div>\n  \n</div>\n\n\n\n    </div>\n  </div>\n\n<div class=\"container\">\n\n\n    <hr>\n\n  </div> \n\n\n\n  <div class='conf' v-for=\"(item,key,i) in conf\" :key=\"i\">\n<div class=\"alert alert-success\"  role=\"alert\">\n  {{key}}={{item}}\n  </div>\n\n\n\n\n\n</div>\n\n\n</main>\n\n\n\n\n\n  </div>\n</template>\n<script src=\"http://oss.sheetjs.com/js-xlsx/xlsx.full.min.js\"></script>\n<script>\n import XLSX from 'xlsx'\nexport default {\n  name: 'Home',\n  data(){\nreturn{\n    confn:'Choose config.xlsx',\n    conf:{},\n    confk:[],\n    confv:[],\n    isShow:false\n  \n}\n  \n  },\n  components: {\n   \n  },\n   created(){\n\n    },\n   mounted(){\n\n    },\n    methods:{\n\n  file(){\n  \n if(this.$refs.file.files[0]){   \n   this.isShow=true;\n     }\n\nthis.confn= this.$refs.file.files[0].name;\n\n  \n                  var k=[1];\n                  var v=[2];\n                  var c={};   \n           var f=this.$refs.file.files[0]\n                var reader = new FileReader(); \n                  reader.readAsBinaryString(f);\n               reader.onload = function(e) {\n                    var data = e.target.result;\n                        \n               var   wb = XLSX.read(data, {\n                            type: 'binary'\n                     });\n                    \n                var seltext=wb.SheetNames[0]\n\n                     var conf={};\n \n                    var curSheet = wb.Sheets[seltext];\n                    // 表格的表格范围，可用于判断表头是否数量是否正确\n                    var fromTo = curSheet['!ref'];\n                    fromTo = fromTo.split(\":\");\n\n                    var startRow = fromTo[0].charCodeAt(0);\n                    var startLine = parseInt(fromTo[0].charAt(1));\n                    var endRow = fromTo[1].charCodeAt(0);\n                    var endLine = parseInt(fromTo[1].substr(1));\n\n                    for (var line = startLine; line < endLine; line++){\n                        var key = null;\n                        var keyrow = startRow;\n\n                        for (var row = startRow; row < endRow; row++){\n                            var cell = String.fromCharCode(row) + line;\n                            var cellStr = curSheet[cell];\n\n                            if (cellStr && cellStr.w && cellStr.w.length > 0) {\n                                if(key  && row == keyrow+1){\n                                 // console.log(cellStr)\n                                    conf[key] = cellStr.w;\n                                    break;\n                                }else{\n                                    key = cellStr.w;\n                                    keyrow = row;\n                                }\n                            }\n                        }\n                    }\n\n              \n\n                var confv=[];\n                   for (var i in conf){  \n                  confv.push(conf[i]);\n\n                  }\n       \n                k=Object.keys(conf);\n                v=confv\n                c=conf;\n             //  reader.readAsBinaryString(f);\n              \n                } \n                setTimeout(()=>{this.confk=k,this.confv=v,this.conf=c}, 100)\n     \n             },\n  start(){\n       if(this.confv.length){\n       \n      this.$store.commit('setConf',this.conf);\n      this.$store.commit('setIsConf',true);\n    console.log(this.$store.state)\n\n        this.$router.push('/config')      \n             }\n  \n  }\n\n    },\n    watch:{\n     \n      },\n    computed:{\n    }\n}\n</script>\n\n<style lang=\"less\">\n// #home {\n//   display: flex;\n//   flex-direction: column;\n//   font-family: Avenir, Helvetica, Arial, sans-serif;\n//   -webkit-font-smoothing: antialiased;\n//   -moz-osx-font-smoothing: grayscale;\n//   //text-align: center;\n//   color: #2c3e50;\n// }\n\n   .bd-placeholder-img {\n        font-size: 1.125rem;\n        text-anchor: middle;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        user-select: none;\n      }\n\n      @media (min-width: 768px) {\n        .bd-placeholder-img-lg {\n          font-size: 3.5rem;\n        }\n      }\nbody {\n  padding-top: 5rem;\n}\n.starter-template {\n  padding: 10rem 1.5rem;\n  text-align: center;\n}\n#inputGroupFileAddon01{\n  cursor: pointer;\n}\n\n.custom-file-input:lang(zh) ~ .custom-file-label::after {\n  content: \"浏览\";\n}\n \n.custom-file-label::after {\n  content: \"浏览\";\n\n}\n.input-group-text{\n  height: 39px;\n}\n.jumbotron{\n  height: 200px;\n\n}\n</style>\n\n\n"]}]}