{"remainingRequest":"/Users/admin/Desktop/my_page/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/admin/Desktop/my_page/src/views/Home.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/admin/Desktop/my_page/src/views/Home.vue","mtime":1599120010172},{"path":"/Users/admin/Desktop/my_page/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/my_page/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/admin/Desktop/my_page/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/admin/Desktop/my_page/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/my_page/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/my_page/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLy8gI2hvbWUgewovLyAgIGRpc3BsYXk6IGZsZXg7Ci8vICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKLy8gICBmb250LWZhbWlseTogQXZlbmlyLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOwovLyAgIC13ZWJraXQtZm9udC1zbW9vdGhpbmc6IGFudGlhbGlhc2VkOwovLyAgIC1tb3otb3N4LWZvbnQtc21vb3RoaW5nOiBncmF5c2NhbGU7Ci8vICAgLy90ZXh0LWFsaWduOiBjZW50ZXI7Ci8vICAgY29sb3I6ICMyYzNlNTA7Ci8vIH0KCiAgIC5iZC1wbGFjZWhvbGRlci1pbWcgewogICAgICAgIGZvbnQtc2l6ZTogMS4xMjVyZW07CiAgICAgICAgdGV4dC1hbmNob3I6IG1pZGRsZTsKICAgICAgICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOwogICAgICAgIC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7CiAgICAgICAgLW1zLXVzZXItc2VsZWN0OiBub25lOwogICAgICAgIHVzZXItc2VsZWN0OiBub25lOwogICAgICB9CgogICAgICBAbWVkaWEgKG1pbi13aWR0aDogNzY4cHgpIHsKICAgICAgICAuYmQtcGxhY2Vob2xkZXItaW1nLWxnIHsKICAgICAgICAgIGZvbnQtc2l6ZTogMy41cmVtOwogICAgICAgIH0KICAgICAgfQpib2R5IHsKICBwYWRkaW5nLXRvcDogNXJlbTsKfQouc3RhcnRlci10ZW1wbGF0ZSB7CiAgcGFkZGluZzogMTByZW0gMS41cmVtOwogIHRleHQtYWxpZ246IGNlbnRlcjsKfQoKCi5jdXN0b20tZmlsZS1pbnB1dDpsYW5nKHpoKSB+IC5jdXN0b20tZmlsZS1sYWJlbDo6YWZ0ZXIgewogIGNvbnRlbnQ6ICLmtY/op4giOwp9CiAKLmN1c3RvbS1maWxlLWxhYmVsOjphZnRlciB7CiAgY29udGVudDogIua1j+iniCI7Cgp9Ci5pbnB1dC1ncm91cC10ZXh0ewogIGhlaWdodDogMzlweDsKfQouanVtYm90cm9uewogIGhlaWdodDogMjAwcHg7Cgp9Cg=="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n\n<div>\n<!--     <nav class=\"navbar navbar-expand-md navbar-dark fixed-top bg-dark\">\n  <a class=\"navbar-brand\" href=\"#\">Navbar</a>\n\n</nav> -->\n\n<main role=\"main\">\n\n  <!-- Main jumbotron for a primary marketing message or call to action -->\n  <div class=\"jumbotron\">\n    <div class=\"container\">\n\n<div class=\"input-group mb-3\">\n\n  <div class=\"input-group-prepend\">\n    <span class=\"input-group-text\" v-show=\"isShow\" id=\"inputGroupFileAddon01\" @click='start()'>Start</span>\n  </div>\n  <div class=\"custom-file\">\n    <input type=\"file\" name='file' ref='file' @change='file()' class=\"custom-file-input\" id=\"inputGroupFile01\" aria-describedby=\"inputGroupFileAddon01\">\n    <label class=\"custom-file-label\" for=\"inputGroupFile01\">{{confn}}</label>\n  </div>\n  \n</div>\n\n\n\n    </div>\n  </div>\n\n<div class=\"container\">\n\n\n    <hr>\n\n  </div> \n\n\n\n  <div class='conf' v-for=\"(item,key,i) in conf\" :key=\"i\">\n<div class=\"alert alert-success\"  role=\"alert\">\n  {{key}}={{item}}\n  </div>\n\n\n\n\n\n</div>\n\n\n</main>\n\n\n\n\n\n  </div>\n</template>\n<script src=\"http://oss.sheetjs.com/js-xlsx/xlsx.full.min.js\"></script>\n<script>\n import XLSX from 'xlsx'\nexport default {\n  name: 'Home',\n  data(){\nreturn{\n    confn:'Choose config.xlsx',\n    conf:{},\n    confk:[],\n    confv:[],\n    isShow:false\n  \n}\n  \n  },\n  components: {\n   \n  },\n   created(){\n\n    },\n   mounted(){\n\n    },\n    methods:{\n\n  file(){\n  \n if(this.$refs.file.files[0]){   \n   this.isShow=true;\n     }\n\nthis.confn= this.$refs.file.files[0].name;\n\n  \n                  var k=[1];\n                  var v=[2];\n                  var c={};   \n           var f=this.$refs.file.files[0]\n                var reader = new FileReader(); \n                  reader.readAsBinaryString(f);\n               reader.onload = function(e) {\n                    var data = e.target.result;\n                        \n               var   wb = XLSX.read(data, {\n                            type: 'binary'\n                     });\n                    \n                var seltext=wb.SheetNames[0]\n\n                     var conf={};\n \n                    var curSheet = wb.Sheets[seltext];\n                    // 表格的表格范围，可用于判断表头是否数量是否正确\n                    var fromTo = curSheet['!ref'];\n                    fromTo = fromTo.split(\":\");\n\n                    var startRow = fromTo[0].charCodeAt(0);\n                    var startLine = parseInt(fromTo[0].charAt(1));\n                    var endRow = fromTo[1].charCodeAt(0);\n                    var endLine = parseInt(fromTo[1].substr(1));\n\n                    for (var line = startLine; line < endLine; line++){\n                        var key = null;\n                        var keyrow = startRow;\n\n                        for (var row = startRow; row < endRow; row++){\n                            var cell = String.fromCharCode(row) + line;\n                            var cellStr = curSheet[cell];\n\n                            if (cellStr && cellStr.w && cellStr.w.length > 0) {\n                                if(key  && row == keyrow+1){\n                                 // console.log(cellStr)\n                                    conf[key] = cellStr.w;\n                                    break;\n                                }else{\n                                    key = cellStr.w;\n                                    keyrow = row;\n                                }\n                            }\n                        }\n                    }\n\n              \n\n                var confv=[];\n                   for (var i in conf){  \n                  confv.push(conf[i]);\n\n                  }\n       \n                k=Object.keys(conf);\n                v=confv\n                c=conf;\n             //  reader.readAsBinaryString(f);\n              \n                } \n                setTimeout(()=>{this.confk=k,this.confv=v,this.conf=c}, 100)\n     \n             },\n  start(){\n       if(this.confv.length){\n       \n      this.$store.commit('setConf',this.conf);\n      this.$store.commit('setIsConf',true);\n    console.log(this.$store.state)\n\n        this.$router.push('/config')      \n             }\n  \n  }\n\n    },\n    watch:{\n     \n      },\n    computed:{\n    }\n}\n</script>\n\n<style lang=\"less\">\n// #home {\n//   display: flex;\n//   flex-direction: column;\n//   font-family: Avenir, Helvetica, Arial, sans-serif;\n//   -webkit-font-smoothing: antialiased;\n//   -moz-osx-font-smoothing: grayscale;\n//   //text-align: center;\n//   color: #2c3e50;\n// }\n\n   .bd-placeholder-img {\n        font-size: 1.125rem;\n        text-anchor: middle;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        user-select: none;\n      }\n\n      @media (min-width: 768px) {\n        .bd-placeholder-img-lg {\n          font-size: 3.5rem;\n        }\n      }\nbody {\n  padding-top: 5rem;\n}\n.starter-template {\n  padding: 10rem 1.5rem;\n  text-align: center;\n}\n\n\n.custom-file-input:lang(zh) ~ .custom-file-label::after {\n  content: \"浏览\";\n}\n \n.custom-file-label::after {\n  content: \"浏览\";\n\n}\n.input-group-text{\n  height: 39px;\n}\n.jumbotron{\n  height: 200px;\n\n}\n</style>\n\n\n"]}]}